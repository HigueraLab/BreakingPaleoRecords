
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Figures_all_script</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-13"><meta name="DC.source" content="Figures_all_script.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">ReadMe</a></li><li><a href="#2">SET working directory and data directory</a></li><li><a href="#3">LOAD lake locations and metadata</a></li><li><a href="#4">LOAD sediment-charocal based fire history data</a></li><li><a href="#5">LOAD MTBS + 2019 + 2020 fire perimiters and ecoregions - SPATIAL DATA</a></li><li><a href="#6">LOAD MTBS + 2019 + 2020 annual area burned - ASPATIAL DATA</a></li><li><a href="#7">LOAD LANDFIRE-defined subalpine forest, within focal study area</a></li><li><a href="#8">LOAD Central Rockies and Grand Lake May-Sep. average VPD, 1979-2020</a></li><li><a href="#9">LOAD paleo climate data</a></li><li><a href="#10">DEFINE geographic extent of Central Rockies and Focal Study Area</a></li><li><a href="#11">CREATE FIGURES</a></li><li><a href="#12">FIGURE 1: Map and contemporary burned area</a></li><li><a href="#13">FIGURE 2: Paleo-fire and climate history</a></li><li><a href="#14">FIGURE S1: Annual area burned area in focal study area (subalpine forest only)</a></li><li><a href="#15">FIGURE S2: paleo fire history and future FRP scenarios</a></li><li><a href="#16">FIGURE S3: Focal study area, with LANDFIRE-defined subalpine vegetation</a></li><li><a href="#17">CALCULATE statistics used in the main text:</a></li></ul></div><h2 id="1">ReadMe</h2><p>Make figures for main text and SI, from: Higuera, P.E., Shuman, B.N., and K.D. Wolf. 202x. Rocky Mountain subalpine forests now burning more than any time in past millennia. In Revisions, PNAS.</p><p><b>FILE REQUIREMENTS:</b></p><pre class="language-matlab">(1) <span class="keyword">...</span><span class="comment">SouthernRockies_site_metadata.csv</span>
(2) <span class="keyword">...</span><span class="comment">Calder_et_al_CharResults.csv</span>
(3) <span class="keyword">...</span><span class="comment">ROMO_CharResults.csv</span>
(4) <span class="keyword">...</span><span class="comment">Minckley_et_al_LWH_CharResults.csv</span>
</pre><pre class="language-matlab">(5) <span class="keyword">...</span><span class="comment">ecoregp075_M331H_M331I.shp</span>
</pre><pre class="language-matlab">(6) <span class="keyword">...</span><span class="comment">SRockies_Fires_1984_2020_WGS84.shp -- Fire perimieteres</span>
(7) <span class="keyword">...</span><span class="comment">AreaBurned_Ecoregion_FocalStudy_1984_2020.csv -- Area burned</span>
statistics
</pre><pre class="language-matlab">(8) <span class="keyword">...</span><span class="comment">EcoSec_M331H_M331I_Mean_VPD_MaySep_1979_2020.csv -- VPD data for</span>
Southern Rockies <span class="string">study</span> <span class="string">area</span>, averaged <span class="string">across</span> <span class="string">space.</span>
(9) <span class="keyword">...</span><span class="comment">GrandLake_Mean_VPD_MaySep_1980_2020.csv -- VPD data for Grank</span>
Lake, CO, as <span class="string">point</span> <span class="string">representation</span> <span class="string">for</span> <span class="string">focal</span> <span class="string">study</span> <span class="string">area.</span>
</pre><pre class="language-matlab">(10)<span class="keyword">...</span><span class="comment">trouet2013nam480pollen.csv</span>
(11)<span class="keyword">...</span><span class="comment">Mann08_nhcru_eiv_composite_updatedCRU_v102520.csv</span>
</pre><p>DEPENDENCIES:   NONE</p><p>Created by: P.E. Higuera Created on: November 2020 Updated: April 2021 Edited: 4/2014 for publication, by P.E. Higuera.</p><p>University of Montana, PaleoEcology and Fire Ecology Lab <a href="https://www.cfc.umt.edu/research/paleoecologylab/">https://www.cfc.umt.edu/research/paleoecologylab/</a> <a href="mailto:philip.higuera@umontana.edu">philip.higuera@umontana.edu</a></p><pre class="codeinput">clear <span class="string">all</span>
close <span class="string">all</span>
</pre><h2 id="2">SET working directory and data directory</h2><pre class="codeinput">wd = cd; <span class="comment">%</span>
dataDir = [wd(1:end-4) <span class="string">'data'</span>];
</pre><h2 id="3">LOAD lake locations and metadata</h2><pre class="codeinput">lakeData = readtable([dataDir <span class="string">'\SouthernRockies_site_metadata.csv'</span>]);
in = lakeData.Use == 1;
lakeData = lakeData(in,:);
</pre><h2 id="4">LOAD sediment-charocal based fire history data</h2><pre class="codeinput">CalderEtAl = readtable([dataDir <span class="string">'\Calder_et_al_CharResults.csv'</span>]);
ROMO = readtable([dataDir <span class="string">'\ROMO_CharResults.csv'</span>]);
LWH = readtable([dataDir <span class="string">'\Minckley_et_al_LWH_CharResults.csv'</span>]);

C = vertcat(CalderEtAl,ROMO,LWH);

in = C.peaks_final == 1;
FireYear = C(in,:);

siteNames = unique(C.site_name);
nSites = length(siteNames);
</pre><h2 id="5">LOAD MTBS + 2019 + 2020 fire perimiters and ecoregions - SPATIAL DATA</h2><pre class="codeinput">firePerimiters = shaperead([dataDir <span class="string">'\SRockies_Fires_1984_2020_WGS84.shp'</span>]);

ecoRegion = shaperead([dataDir <span class="string">'\ecoregp075_M331H_M331I.shp'</span>]);
[lonSoRockies,latSoRockies] = polybool(<span class="string">'union'</span>,ecoRegion(1).X,ecoRegion(1).Y,ecoRegion(2).X,ecoRegion(2).Y);
</pre><h2 id="6">LOAD MTBS + 2019 + 2020 annual area burned - ASPATIAL DATA</h2><pre class="codeinput">CR_AB = importdata([dataDir <span class="string">'\AreaBurned_Ecoregion_FocalStudy_1984_2020.csv'</span>]);
        <span class="comment">% Area burned statistics for M331H + M331I ecosections (combiend),</span>
        <span class="comment">% for all and subalpine forest only, and for "focal study area"</span>
        <span class="comment">% within these combined ecosections.</span>

yr_aab = [1984:2020]; <span class="comment">% [yr CE]</span>
aab = zeros(length(yr_aab),2); <span class="comment">% [ha]</span>
<span class="keyword">for</span> i = 1:length(yr_aab)
    yrIn = find(CR_AB.data(:,1) == yr_aab(i));
    <span class="keyword">if</span> yrIn
        aab(i,1) = sum(CR_AB.data(yrIn,2)); <span class="comment">% [ha] Ecoregion AAB</span>
        aab(i,2) = sum(CR_AB.data(yrIn,5)); <span class="comment">% [ha] Subalpine forest in</span>
                                            <span class="comment">% in focal study area AAB</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2 id="7">LOAD LANDFIRE-defined subalpine forest, within focal study area</h2><pre class="codeinput">[A,R] = geotiffread([dataDir <span class="string">'\SRockies_SubalpineConiferForestESP_WGS84.tif'</span>]);
subalpineForest = double(A);
</pre><h2 id="8">LOAD Central Rockies and Grand Lake May-Sep. average VPD, 1979-2020</h2><pre class="codeinput">VPD = readtable([dataDir <span class="string">'\EcoSec_M331H_M331I_Mean_VPD_MaySep_1979_2020.csv'</span>]);
VPD_GrandLake = readtable([dataDir <span class="string">'\GrandLake_Mean_VPD_MaySep_1980_2020.csv'</span>]);
</pre><h2 id="9">LOAD paleo climate data</h2><pre class="codeinput">TrouetTemp = csvread([dataDir <span class="string">'\trouet2013nam480pollen.csv'</span>],106);
Mann08 = csvread([dataDir <span class="string">'\Mann08_nhcru_eiv_composite_updatedCRU_v102520.csv'</span>],1);
<span class="comment">% SOURCE: https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT4-nh.dat https://crudata.uea.ac.uk/cru/data/temperature/</span>
<span class="comment">% Downloaded 10/25/20 2:46 pm MT</span>
<span class="comment">% 10-yr moving average, extended from 2006 with CRU.</span>
</pre><h2 id="10">DEFINE geographic extent of Central Rockies and Focal Study Area</h2><pre class="codeinput"><span class="comment">% *Southern Rockies study area*</span>
latlim = [38.35 42.8];      <span class="comment">% [decimal deg.]</span>
lonlim = [-108.6 -104.5];   <span class="comment">% [decimal deg.]</span>

<span class="comment">% *Focal study area: used for FRP calculations to compare to paleo FRP*</span>
latlimFoc = [39.75 41.7];   <span class="comment">% [decimal deg.]</span>
lonlimFoc = [-107.8 -105];  <span class="comment">% [decimal deg.]</span>
</pre><h2 id="11">CREATE FIGURES</h2><pre class="codeinput">smFig = [1 2 9 6];
medFig = [1 2 11 15]; <span class="comment">% 11 11</span>
lrgFig = [1 2 18 22];  <span class="comment">% 18 22</span>
fs = 8; <span class="comment">% Font size</span>

<span class="comment">% 1 column wide (20.5 picas / 3.42&#8221; / 8.7 cm)</span>
<span class="comment">% 1.5 columns wide (27 picas / 4.5&#8221; / 11.4 cm)</span>
<span class="comment">% 2 columns wide (42.125 picas / 7&#8221; / 17.8 cm)</span>
<span class="comment">% Provide all images at final size. While figures may be sized conservatively</span>
<span class="comment">% to save page space, PNAS reserves the right to make the final decision on</span>
<span class="comment">% figure size in published articles and authors may be asked to shorten</span>
<span class="comment">% manuscripts that exceed the stated length requirement.</span>
<span class="comment">% Small: approximately 9 cm x 6 cm</span>
<span class="comment">% Medium: approximately 11 cm x 11 cm</span>
<span class="comment">% Large: approximately 18 cm x 22 cm</span>
<span class="comment">%</span>
<span class="comment">% Ensure that all numbers, letters, and symbols are no smaller than 6 points</span>
<span class="comment">% (2 mm) and no larger than 12 points (6 mm) after reduction. Keep text</span>
<span class="comment">% sizing consistent within each graphic.</span>
<span class="comment">% Preassemble all composite figures.</span>
<span class="comment">% Submit images in these file formats: TIFF, EPS, PDF, or PPT.</span>

<span class="comment">% https://www.pnas.org/authors/submitting-your-manuscript#manuscript-formatting-guidelines</span>
</pre><h2 id="12">FIGURE 1: Map and contemporary burned area</h2><pre class="codeinput">figure(1); clf;
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Units'</span>,<span class="string">'Centimeters'</span>,<span class="string">'position'</span>,medFig)
ax = subplot(3,2,[2 4]);
pos = get(ax,<span class="string">'Position'</span>);
set(ax,<span class="string">'color'</span>,<span class="string">'none'</span>,<span class="string">'xcolor'</span>,<span class="string">'none'</span>,<span class="string">'ycolor'</span>,<span class="string">'none'</span>)

<span class="comment">% *A: Southern Rockies study area*</span>
gx = geoaxes;
hold <span class="string">on</span>
a1 = geoplot(latSoRockies,lonSoRockies,<span class="string">'color'</span>,[0.5 0.5 0.5],<span class="keyword">...</span>
    <span class="string">'Linewidth'</span>,2);

<span class="comment">% *Plot MTBS + 2019 + 2020 fire perimiters*</span>
nFires = length(firePerimiters);
yr_aab = [1984:2020];
<span class="keyword">for</span> i = 1:nFires
    <span class="keyword">if</span> strcmp(firePerimiters(i).Year,<span class="string">'2020'</span>)
        a3 = geoplot(firePerimiters(i).Y,firePerimiters(i).X,<span class="string">'-r'</span>,<span class="keyword">...</span>
        <span class="string">'Color'</span>,[0.6 0 0],<span class="string">'linewidth'</span>,2);
    <span class="keyword">else</span>
        a2 = geoplot(firePerimiters(i).Y,firePerimiters(i).X,<span class="string">'-r'</span>,<span class="keyword">...</span>
        <span class="string">'Color'</span>,[1 .25 .25],<span class="string">'linewidth'</span>,1);
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% *Plot focal study area*</span>
a4 = geoplot([latlimFoc(1) latlimFoc(1) latlimFoc(2) latlimFoc(2) latlimFoc(1)],<span class="keyword">...</span>
    [lonlimFoc(1) lonlimFoc(2) lonlimFoc(2) lonlimFoc(1) lonlimFoc(1)],<span class="keyword">...</span>
    <span class="string">'color'</span>,[0.25 0.25 0.25],<span class="string">'linewidth'</span>,2);
geoplot(39.7392, -104.9,<span class="string">'sk'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>)
text(39.65, -105.35,<span class="string">'\itDenver'</span>,<span class="string">'Color'</span>,[0 0 0])

<span class="comment">% *Plot lake locations*</span>
in = 1+[3 4 5 6 7 8 10 13 14 16 17 19]; <span class="comment">% Index for lakes burned in MCA</span>
a5 = geoplot(lakeData.Latitude,lakeData.Longitude,<span class="string">'ok'</span>,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'w'</span>,<span class="string">'MarkerSize'</span>,7);
a6 = geoplot(lakeData.Latitude(in),lakeData.Longitude(in),<span class="string">'or'</span>,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,[1 .25 .25],<span class="string">'MarkerSize'</span>,1.75);

<span class="comment">% *Plot tree-ring studies*</span>
ms = 6;
lw = 1.1;
a7 = geoplot(41.489185, -106.182506,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Kipfmuller and Baker (2000)</span>
geoplot(40.438131, -105.571230,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Buechling and Baker (2004)</span>
geoplot(40.80, -106.72,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Howe and Baker (2003)% geoplot(40.875, -107.05,'vk','MarkerFaceColor','none')</span>
geoplot(40.3, -105.73,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Sibold et al. (2006)</span>

<span class="comment">% *SET Basemap*</span>
geobasemap(<span class="string">'landcover'</span>)
<span class="comment">% geobasemap('usgsimageryonly')</span>
geolimits(latlim,lonlim)
grid <span class="string">on</span>
<span class="comment">% pos = [0.1094    -0.9 0.8521    0.8];</span>
pos = [0.1094    0.3268    0.8521    0.6537];
set(gx,<span class="string">'fontsize'</span>,fs,<span class="keyword">...</span><span class="comment">%'LongitudeLabel',[],'LatitudeLabel',[],...</span>
    <span class="string">'Position'</span>,pos,<span class="string">'MapCenter'</span>,[40.6 -107.4],<span class="string">'color'</span>,<span class="string">'none'</span>)
gx.LatitudeLabel.String = <span class="string">' '</span>;
gx.LongitudeLabel.String = <span class="string">''</span>;
gx.Grid = <span class="string">'off'</span>;
lgd = legend([a1 a4 a2 a3 a5 a6 a7],<span class="string">'Ecoregion'</span>,<span class="string">'Focal study area'</span>,<span class="string">'Fires, 1984-2019'</span>,<span class="keyword">...</span>
    <span class="string">'Fires, 2020'</span>,<span class="string">'Lake (n = 20)'</span>,<span class="string">'Lake, MCA fire'</span>,<span class="string">'Dendro. (n = 4)'</span>,<span class="string">'Location'</span>,<span class="keyword">...</span>
    <span class="string">'West'</span>,<span class="string">'FontSize'</span>,fs);
lgd.Position = [0.1362 0.54 0.3173 0.1852];
text(42.70,-110.67,<span class="string">'A'</span>,<span class="string">'FontSize'</span>,14,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>)

<span class="comment">% *West-wide map*</span>
ax = subplot(3,2,6);
pos = get(ax,<span class="string">'Position'</span>);
set(ax,<span class="string">'color'</span>,<span class="string">'none'</span>,<span class="string">'xcolor'</span>,<span class="string">'none'</span>,<span class="string">'ycolor'</span>,<span class="string">'none'</span>)

states = shaperead(<span class="string">'usastatehi'</span>); <span class="comment">% State outlines</span>
name = <span class="string">'usgsimageryonly'</span>;
<span class="comment">% name = 'colorterrain';</span>
        <span class="comment">%%%% USGS Imagery + Topo</span>
        url = <span class="string">"https://basemap.nationalmap.gov/ArcGIS/rest/services/USGSImageryOnly/MapServer/tile/${z}/${y}/${x}"</span>;
        <span class="comment">% name = 'fulldataset'</span>
        <span class="comment">% url = "https://services3.arcgis.com/T4QMspbfLg3qTGWY/arcgis/rest/services/Public_Wildfire_Perimeters_View/FeatureServer/0/query?outFields=*&amp;where=1%3D1";</span>
        <span class="comment">% %%%% USGS Imagery + Topo</span>
        <span class="comment">% name = 'usgsimagerytopo';</span>
        <span class="comment">% url = "https://basemap.nationalmap.gov/ArcGIS/rest/services/USGSImageryTopo/MapServer/tile/${z}/${y}/${x}";</span>
        attribution = <span class="string">"USGS"</span>;
        addCustomBasemap(name,url,<span class="string">'Attribution'</span>,attribution,<span class="keyword">...</span>
            <span class="string">'MaxZoomLevel'</span>,25)
gx = geoaxes;
hold <span class="string">on</span>
<span class="keyword">for</span> i = 1:47
    geoplot(states(i).Y,states(i).X,<span class="string">'color'</span>,[0.6 0.6 0.6])
<span class="keyword">end</span>
a1 = geoplot(latSoRockies,lonSoRockies,<span class="string">'color'</span>,[0.75 0.75 0.75],<span class="string">'Linewidth'</span>,1);

geobasemap(name)
latlimWest = [30.5 49.5];
lonlimWest = [-125 -102];
geolimits(latlimWest,lonlimWest)
grid <span class="string">off</span>
gx.LongitudeAxis.Visible = <span class="string">'off'</span>; gx.LatitudeAxis.Visible = <span class="string">'off'</span>;
pos = [0.1370    0.7366    0.3173    0.2264];
set(gx,<span class="string">'fontsize'</span>,fs-2,<span class="keyword">...</span><span class="comment">%'LongitudeLabel',[],'LatitudeLabel',[],...</span>
    <span class="string">'Position'</span>,pos,<span class="string">'AxisColor'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1)

<span class="comment">% *B: Annual area burned and climate time series*</span>
subplot(3,2,[5 6])
x_lim = [1983 2021.5];
x = yr_aab;
y = aab(:,1); <span class="comment">% [ha] Area burned in entire study region.</span>

h = bar(x,y,1);
    h(1).FaceColor = <span class="string">'flat'</span>;
    h(1).CData = [0.9 0.25 0.25];
xlabel(<span class="string">'Year (CE)'</span>)
ylabel(<span class="string">'Area burned (ha)'</span>)
set(gca,<span class="string">'yscale'</span>,<span class="string">'log'</span>,<span class="string">'YTick'</span>,[100 10000 1000000])
hold <span class="string">on</span>
<span class="keyword">for</span> i = [2002 2012 2016 2018 2020]
    in = find(x == i);
    propAb = round(100*(y(in)./sum(y)));
    text(i,1.25*y(in),[num2str(propAb) <span class="string">'%'</span>],<span class="string">'Rotation'</span>,0,<span class="string">'FontSize'</span>,fs-2,<span class="keyword">...</span>
        <span class="string">'HorizontalAlignment'</span>,<span class="keyword">...</span>
        <span class="string">'Center'</span>,<span class="string">'VerticalAlignment'</span>,<span class="string">'Bottom'</span>)
<span class="keyword">end</span>

yyaxis <span class="string">right</span>
x2 = VPD.Year(6:end);
y3 = VPD.VPD_kPa(6:end);
h2 = plot(x2,y3,<span class="string">'k'</span>,<span class="string">'linewidth'</span>,2);
[r, p] = corr(y,y3,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between VPD and AAB</span>
text(1985,1.225,[<span class="string">'\rho = '</span> num2str(round(r*100)/100)],<span class="string">'FontSize'</span>,fs+2)

[r p] = corr(x2,y3,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between VPD and year</span>
[r p] = corr(x',y,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between aab and year</span>

ylabel(<span class="string">'VPD (kPa)'</span>,<span class="string">'Rotation'</span>,270,<span class="string">'VerticalAlignment'</span>,<span class="string">'Bottom'</span>)
ylim([0.85 1.5])
legend([h h2],<span class="string">'Area burned'</span>,<span class="string">'May-Sep. VPD'</span>,<span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'NorthWest'</span>,<span class="string">'FontSize'</span>,fs);
xlim(x_lim)
pos = [0.1250    0.0582    0.78    0.2222];<span class="comment">%[0.0973    0.0859    0.8878    0.2802];</span>
set(gca,<span class="string">'ycolor'</span>,<span class="string">'k'</span>,<span class="string">'position'</span>,pos,<span class="string">'fontsize'</span>,fs)
text(1979,1.475,<span class="string">'B'</span>,<span class="string">'FontSize'</span>,14,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>)
</pre><img vspace="5" hspace="5" src="Figures_all_script_01.png" alt=""> <h2 id="13">FIGURE 2: Paleo-fire and climate history</h2><pre class="codeinput">figure(2); clf
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Units'</span>,<span class="string">'Centimeters'</span>,<span class="string">'position'</span>,[1 2 11.4 22])
x_lim = [-65 2020];
x_tick = [0:200:2020];

<span class="comment">%%%% Plot paleo-fire network</span>
subplot(4,1,[1])
[lat, orderIn] = sort(lakeData.Latitude,<span class="string">'ascend'</span>);
yr_i = [0:25:1950]; <span class="comment">% [yr CE]</span>
<span class="keyword">for</span> i = 1:nSites
    in = find(strncmp(siteNames(orderIn(i)),C.site_name,10)); <span class="comment">% Index for sample from site i.</span>
    x = 1950-C.age_top(in);
    y = C.char_acc(in);
    peak = C.peaks_final(in);
    in = peak &gt; 0;
    x2 = x(in);
    y2 = peak(in);
    <span class="keyword">if</span> i == 1; hold <span class="string">on</span>; <span class="keyword">end</span>
    plot(x,i.*ones(size(x)),<span class="string">'k-'</span>)
    plot(x2,y2.*i,<span class="string">'ok'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>)
    in2 = find([x2 &lt; 820+50] .* [x2 &gt;= 820-50]);
    plot(x2(in2),y2(in2).*i,<span class="string">'ok'</span>,<span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25])
<span class="keyword">end</span>
plot(1950-[850 850],[0 nSites+2],<span class="string">'--k'</span>)
plot(1950-[1200 1200],[0 nSites+2],<span class="string">'--k'</span>)
pos = [0.1100    0.70    0.75    0.2558];
set(gca,<span class="string">'xdir'</span>,<span class="string">'normal'</span>,<span class="string">'ytick'</span>,[1:nSites],<span class="string">'yticklabel'</span>,siteNames(orderIn),<span class="keyword">...</span>
    <span class="string">'xlim'</span>,x_lim,<span class="string">'xtick'</span>,x_tick,<span class="string">'XTickLabel'</span>,[1950-x_tick],<span class="keyword">...</span>
    <span class="string">'ylim'</span>,[0 nSites],<span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
    <span class="string">'XAxisLocation'</span>,<span class="string">'Top'</span>,<span class="string">'YTick'</span>,[1:2:20],<span class="string">'YTickLabel'</span>,fliplr([2:2:20]),<span class="keyword">...</span>
    <span class="string">'FontSize'</span>,fs,<span class="string">'color'</span>,<span class="string">'none'</span>,<span class="string">'position'</span>,pos)
grid <span class="string">on</span>
xlabel(<span class="string">'Time (yr BP)'</span>)
ylabel(<span class="string">'Site ID'</span>)

<span class="comment">%%%% Plot paleo temperature records</span>
subplot(4,1,3)
hold <span class="string">on</span>
x = Mann08(:,1);
in = find([x &gt;= 1900] .* [x &lt; 2000]);
y = Mann08(:,2) - mean(Mann08(in,2));
x2 = TrouetTemp(:,1);
in = find([x2 &gt;= 1900] .* [x2 &lt; 2000]);
y2 = TrouetTemp(:,2);<span class="comment">% - mean(TrouetTemp(:,2));</span>

plot(x,y,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'color'</span>,[0.8 0.25 0.25]);
plot(x2,y2,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2);
y_lim = [-0.82 1.25]; <span class="comment">%get(gca,'ylim');</span>
plot(1950-[850 850],y_lim,<span class="string">'--k'</span>)
plot(1950-[1200 1200],y_lim,<span class="string">'--k'</span>)
ylim(y_lim)
xlim(x_lim)
text(550,0.2,<span class="string">'Mann et al. (2009)'</span>,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>,<span class="keyword">...</span>
    <span class="string">'FontSize'</span>,fs,<span class="string">'Color'</span>,[0.5 0.5 0.5])
text(599,-0.40,<span class="string">'Trouet et al. (2013)'</span>,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>,<span class="keyword">...</span>
    <span class="string">'FontSize'</span>,fs,<span class="string">'Color'</span>,[0.5 0.5 0.5])
ylabel(<span class="string">'Mean ann. temp. anomaly (\circ C)'</span>,<span class="string">'Rotation'</span>,270,<span class="keyword">...</span>
    <span class="string">'VerticalAlignment'</span>,<span class="string">'Bottom'</span>)
pos = [ 0.1100    0.5128    0.75    0.2959];
set(gca,<span class="string">'xcolor'</span>,<span class="string">'none'</span>,<span class="string">'YAxisLocation'</span>,<span class="string">'Right'</span>,<span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
    <span class="string">'Xtick'</span>,x_tick,<span class="string">'color'</span>,<span class="string">'none'</span>,<span class="string">'position'</span>,pos,<span class="string">'fontsize'</span>,fs,<span class="keyword">...</span>
    <span class="string">'YTick'</span>,[-0.5 0 0.5 1 1.5],<span class="string">'YTickLabel'</span>,{<span class="string">'-0.5'</span> <span class="string">'0'</span> <span class="string">'0.5'</span> <span class="string">'1'</span>})
box <span class="string">off</span>
grid <span class="string">on</span>

<span class="comment">%%%% Plot percent sites burned summary</span>
subplot(4,1,[4])
x_lim_C = [x_lim(1) 2110];
y_lim = [0.25 1.55];
fireYears = 1950-FireYear.age_top;
timeWindow = 100; <span class="comment">% [yr]</span>
timeIncrement = 10; <span class="comment">% [yr]</span>
xi = [0:timeIncrement:1950]; <span class="comment">% [yr CE]</span>
nFires_i = NaN(size(xi));
nSites_i = NaN(size(xi));
<span class="keyword">for</span> i = 1:length(xi)
    target = [xi(i)-timeWindow/2 xi(i)+timeWindow/2];
    in = find([fireYears &gt; target(1)] .* [fireYears &lt;= target(2)]);
    nFires_i(i) = length(in); <span class="comment">% [#] Total number of fires in target window.</span>

    in2 = find([(1950-C.age_top) &gt; target(1)] .*<span class="keyword">...</span>
        [(1950-C.age_top) &lt;= target(2)]);
    nSites_i(i) = length(unique(C.site_name(in2))); <span class="comment">% [#] Number of sites recording.</span>
<span class="keyword">end</span>
perSitesBurned = nFires_i./nSites_i; <span class="comment">% [%] Percent sites burned</span>
yi = smooth(perSitesBurned,timeIncrement,<span class="string">'lowess'</span>);

PSB_ci = prctile(perSitesBurned,[12.5 100-12.5]);
X = [0 2005 2005 0 0];
Y = [PSB_ci(1) PSB_ci(1) PSB_ci(2) PSB_ci(2) PSB_ci(1)];
c = fill(X,Y,[0.9 0.9 0.9],<span class="string">'EdgeColor'</span>,[0.75 0.75 0.75]);
hold <span class="string">on</span>
b = plot([0 2005],[median(perSitesBurned) median(perSitesBurned)],<span class="string">'r'</span>,<span class="string">'Color'</span>,<span class="keyword">...</span>
    [0.8 0.25 0.25]);
a = plot(xi,yi,<span class="string">'-r'</span>,<span class="string">'linewidth'</span>,2,<span class="string">'color'</span>,[0.8 0.25 0.25]);
plot(1950-[850 850],y_lim,<span class="string">'k--'</span>)
plot(1950-[1200 1200],y_lim,<span class="string">'k--'</span>)
grid <span class="string">on</span>

ylabel(<span class="string">'Sites burned per century (%)'</span>)
y_tick = [0.25 100/300 100/230 0.5 0.6664 100/117 1  100/68];
set(gca,<span class="string">'ycolor'</span>,<span class="string">'k'</span>,<span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="string">'xtick'</span>,[0:200:2020],<span class="string">'ytick'</span>,<span class="keyword">...</span>
    [0.25 0.5 1 ],<span class="string">'yticklabel'</span>,<span class="keyword">...</span>
    [25 50 100])
ylim(y_lim)
xlim(x_lim_C)
yyaxis <span class="string">right</span>
ylim(y_lim)
pos3 = ((1+diff(x_lim_C))*0.75)/(1+diff(x_lim));
pos = [0.1100    0.125    pos3    0.3925];

set(gca,<span class="string">'ytick'</span>,y_tick,<span class="string">'ycolor'</span>,<span class="string">'k'</span>,<span class="string">'fontsize'</span>,fs,<span class="string">'yticklabel'</span>,<span class="keyword">...</span>
    round(100./y_tick),<span class="string">'position'</span>,pos,<span class="string">'color'</span>,<span class="string">'none'</span>)
text(2350, y_lim(1)+0.5*diff(y_lim),<span class="string">'Fire rotation period (yr)'</span>,<span class="keyword">...</span>
    <span class="string">'Rotation'</span>,270,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>,<span class="string">'FontSize'</span>,fs)
xlabel(<span class="string">'Time (yr CE)'</span>)
box <span class="string">off</span>

<span class="comment">%%%% Add future range of variability</span>
X2 = [2000 2100 2100 2000 2000];
Y2 = [100/74 100/74 100/177 100/177 100/74];
f = fill(X2,Y2,[0.98 0.72 0.72],<span class="string">'EdgeColor'</span>,[0.8 0 0]);

<span class="comment">% *Add tree-ring based fire rotation periods:*</span>
<span class="comment">%     dendroFRP = [145 273 238 405 326 346 281 127]; % Sibold et al. 2007</span>
<span class="comment">%         % (values 1-5 here, from Table 4) + Bucheling and Baker 2004 (346) +</span>
<span class="comment">%         % Howe and Baker 2003 (281) + Kipfmueller and Baker 2000 (127),</span>
<span class="comment">%         % as summarized in Baker (2009, Table 8.1).</span>
<span class="comment">%     dendro_FRPci = prctile(bootstrp(10000,'mean',dendroFRP),[2.5 97.5]);</span>
<span class="comment">%     SiboldYr = [-50 1950-1650];</span>
<span class="comment">%     plot([1700 2000],[100/mean(dndroFRP) 100/mean(dndroFRP)],'k-')</span>
<span class="comment">%     plot([1852 1852],100./dendro_FRPci,'k-')</span>
<span class="comment">% d = plot(1852,100/mean(dndroFRP),'sk','markerfacecolor',[0.8 0.25 0.25],...</span>
<span class="comment">%         'markersize',10);</span>

<span class="comment">%%%% Split up dendro data into two time periods</span>
    dendroFRP_1737 = [252 227 217 634 420 127 349 281];
    dendroFRP_1904 = [338 329 215 247 1293 170 332 295];
        <span class="comment">% Sibold et al. 2007</span>
        <span class="comment">% (values 1-5 here, from Table 4) + Bucheling and Baker 2004 (346) +</span>
        <span class="comment">% Howe and Baker 2003 (281) + Kipfmueller and Baker 2000 (127),</span>
        <span class="comment">% as summarized in Baker (2009, Table 8.1).</span>
    dendroFRP_1760ci = prctile(bootstrp(10000,<span class="string">'median'</span>,dendroFRP_1737),[2.5 97.5]);
    dendroFRP_1936ci = prctile(bootstrp(10000,<span class="string">'median'</span>,dendroFRP_1904),[2.5 97.5]);
    plot([1611 1863],[100/median(dendroFRP_1737) 100/median(dendroFRP_1737)],<span class="string">'k-'</span>)
    plot([1737 1737],100./dendroFRP_1760ci,<span class="string">'k-'</span>)
    plot([1864 1944],[100/median(dendroFRP_1904) 100/median(dendroFRP_1904)],<span class="string">'k-'</span>)
    plot([1904 1904],100./dendroFRP_1936ci,<span class="string">'k-'</span>)
d = plot(1737,100/median(dendroFRP_1737),<span class="string">'sk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'markersize'</span>,8);
    plot(1904,100/median(dendroFRP_1904),<span class="string">'sk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'markersize'</span>,8);

<span class="comment">%%%% Plot contemporary FRPs</span>
e = plot(2000,100/204,<span class="string">'dk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
    <span class="string">'MarkerSize'</span>,8); <span class="comment">% c. 204 yr FRP: 1984-2020</span>
plot([2000 2100],[100/117 100/117],<span class="string">'r-'</span>,<span class="string">'color'</span>,[0.8 0.25 0.25])
plot(2010,100/117,<span class="string">'dk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
    <span class="string">'MarkerSize'</span>,8); <span class="comment">% c. 117 yr FRP: 2000-2020</span>
plot(2020,100/68,<span class="string">'dk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
    <span class="string">'MarkerSize'</span>,8) <span class="comment">% c. 68 yr FRP: 2000-2020</span>
text(2010,100/68,<span class="string">'2010-2020  '</span>,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>,<span class="keyword">...</span>
    <span class="string">'Color'</span>,[0.8 0.25 0.25],<span class="string">'fontsize'</span>,fs)
text(2000,100/117,<span class="string">'2000-2020  '</span>,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>,<span class="keyword">...</span>
    <span class="string">'Color'</span>,[0.8 0.25 0.25],<span class="string">'fontsize'</span>,fs)
text(1995,0.5,<span class="string">'1984-2020   '</span>,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>,<span class="keyword">...</span>
    <span class="string">'Color'</span>,[0.3 0.3 0.3],<span class="string">'Rotation'</span>,-45,<span class="string">'fontsize'</span>,fs)
text([750+(1100-750)/2],0.875,<span class="string">'MCA'</span>,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>,<span class="keyword">...</span>
    <span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)

<span class="comment">%%%% Annotate figure</span>
text(-300,1.15+1.9,<span class="string">'A'</span>,<span class="string">'FontSize'</span>,12,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>)
text(-300,0.9+1.15,<span class="string">'B'</span>,<span class="string">'FontSize'</span>,12,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>)
text(-300,0.75+0.75,<span class="string">'C'</span>,<span class="string">'FontSize'</span>,12,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>)
legend([a,b,c,d,e,f],<span class="string">'Lake sed.: 100-yr rate of burning'</span>,<span class="keyword">...</span>
    <span class="string">'Lake sed.: median'</span>,<span class="string">'Lake sed.: central 75% of HRV'</span>,<span class="keyword">...</span>
    <span class="string">'Tree rings: median FRP (95% CI)'</span>,<span class="keyword">...</span>
    <span class="string">'Observational: FRP'</span>,<span class="keyword">...</span>
    <span class="string">'21^s^t-century FRP scenarios'</span>,<span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'NorthWest'</span>,<span class="string">'FontSize'</span>,8)
</pre><img vspace="5" hspace="5" src="Figures_all_script_02.png" alt=""> <h2 id="14">FIGURE S1: Annual area burned area in focal study area (subalpine forest only)</h2><pre class="codeinput">figure(3); clf;
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Units'</span>,<span class="string">'Centimeters'</span>,<span class="string">'position'</span>,[1 1 11.0067 4.5])

x_lim = [1983 2021.5];
x = yr_aab;
y = aab(:,2); <span class="comment">% [ha] Area burned in entire study region.</span>

h = bar(x,y,1);
    h(1).FaceColor = <span class="string">'flat'</span>;
    h(1).CData = [0.9 0.25 0.25];
xlabel(<span class="string">'Year (CE)'</span>)
ylabel(<span class="string">'Area burned (ha)'</span>)
set(gca,<span class="string">'yscale'</span>,<span class="string">'log'</span>,<span class="string">'YTick'</span>,[100 10000 1000000])
ylim([0.1 1000000])
hold <span class="string">on</span>
<span class="keyword">for</span> i = [2002 2012 2016 2018 2020]
    in = find(x == i);
    propAb = round(100*(y(in)./sum(y)));
    text(i,1.1*y(in),[num2str(propAb) <span class="string">'%'</span>],<span class="string">'Rotation'</span>,0,<span class="string">'FontSize'</span>,fs-2,<span class="keyword">...</span>
        <span class="string">'HorizontalAlignment'</span>,<span class="keyword">...</span>
        <span class="string">'Center'</span>,<span class="string">'VerticalAlignment'</span>,<span class="string">'Bottom'</span>)
 <span class="keyword">end</span>

yyaxis <span class="string">right</span>
x2 = VPD_GrandLake.Year(5:end);
y3 = VPD_GrandLake.VPD_kPa(5:end);
h2 = plot(x2,y3,<span class="string">'k'</span>,<span class="string">'linewidth'</span>,2);
[r p] = corr(y,y3,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between VPD and AAB</span>
text(1985,1.25,[<span class="string">'\rho = '</span> num2str(round(r*100)/100)],<span class="string">'FontSize'</span>,fs+2)

[r p] = corr(x2,y3,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between VPD and year</span>
[r p] = corr(x',y,<span class="string">'Type'</span>,<span class="string">'Spearman'</span>); <span class="comment">% Correlation between aab and year</span>

ylabel(<span class="string">'VPD (kPa)'</span>,<span class="string">'Rotation'</span>,270,<span class="string">'VerticalAlignment'</span>,<span class="string">'Bottom'</span>)
ylim([0.85 1.5])
legend([h h2],<span class="string">'Area burned'</span>,<span class="string">'May-Sep. VPD'</span>,<span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'NorthWest'</span>,<span class="string">'FontSize'</span>,fs-0)
xlim(x_lim)
set(gca,<span class="string">'ycolor'</span>,<span class="string">'k'</span>,<span class="string">'fontsize'</span>,fs)
</pre><img vspace="5" hspace="5" src="Figures_all_script_03.png" alt=""> <h2 id="15">FIGURE S2: paleo fire history and future FRP scenarios</h2><pre class="codeinput">figure(4); clf
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Units'</span>,<span class="string">'Centimeters'</span>,<span class="string">'position'</span>,[1 2 18.3 24.7/3])
y_lim = [45 350];

subplot(1,6,[1 3])
<span class="comment">%%%% This study - composite charcoal record</span>
plot([0 2000],[230 230],<span class="string">'k'</span>)
hold <span class="string">on</span>
plot([1000 1000],100./PSB_ci,<span class="string">'k'</span>) <span class="comment">% 25-75 percentile;</span>
a1 = plot(1000,230,<span class="string">'hk'</span>,<span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>,8);
plot([840 840],[150 150],<span class="string">'k'</span>)
a2 = plot(840,150,<span class="string">'*k'</span>,<span class="string">'Color'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>,8);

<span class="comment">%%%% Higuera et al. 2014</span>
plot([-4000 2000],[293 293],<span class="string">'k'</span>)
plot([-1000 -1000],[249 341],<span class="string">'k'</span>)
a3 = plot(-1000,293,<span class="string">'pk'</span>,<span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>,8);

<span class="comment">%%%% Tree-ring records</span>
<span class="comment">% plot([1700 2000],[270 270],'k')</span>
<span class="comment">% plot([1850 1850],[205 329],'k')</span>
<span class="comment">% a4 = plot(1850,270,'sk','MarkerFaceColor',[0.8 0.25 0.25],'MarkerSize',8);</span>
<span class="comment">% pos = [0.0808    0.1412    0.3714    0.7288];</span>
<span class="comment">% set(gca,'yscale','log','FontSize',fs,'position',pos)</span>
<span class="comment">% ylim(y_lim)</span>
<span class="comment">% ylabel('Fire rotation period (yr)')</span>
<span class="comment">% grid on</span>
<span class="comment">% box off</span>

plot([1650 1870],[median(dendroFRP_1737) median(dendroFRP_1737)],<span class="string">'k-'</span>)
plot([1760 1760],dendroFRP_1760ci,<span class="string">'k-'</span>)
plot([1871 2000],[median(dendroFRP_1904) median(dendroFRP_1904)],<span class="string">'k-'</span>)
plot([1936 1936],dendroFRP_1936ci,<span class="string">'k-'</span>)
a4 = plot(1760,median(dendroFRP_1737),<span class="string">'sk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'markersize'</span>,8);
    plot(1936,median(dendroFRP_1904),<span class="string">'sk'</span>,<span class="string">'markerfacecolor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'markersize'</span>,8);

pos = [0.0808    0.1412    0.3714    0.7288];
set(gca,<span class="string">'yscale'</span>,<span class="string">'log'</span>,<span class="string">'FontSize'</span>,fs,<span class="string">'position'</span>,pos)
ylim(y_lim)
ylabel(<span class="string">'Fire rotation period (yr)'</span>)
grid <span class="string">on</span>
box <span class="string">off</span>

legend([a3 a1 a2 a4],<span class="string">'Sed.-charcoal records (Higuera et al. 2014)'</span>,<span class="keyword">...</span>
    <span class="string">'Sed.-charcoal records (this study)'</span>,<span class="keyword">...</span>
    <span class="string">'MCA max. burning rate (this study)'</span>,<span class="keyword">...</span>
    <span class="string">'Tree-ring records (see caption)'</span>,<span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'Southwest'</span>)
title(<span class="string">'A  Paleo'</span>,<span class="string">'FontSize'</span>,fs+4)
xlabel(<span class="string">' '</span>)

<span class="comment">%%%% Contemporary FRP</span>
subplot(1,6,4)

A = 1395870; <span class="comment">% [ha] Size of focal study area</span>
t = [1984 2020; 2000 2020; 2010 2020]; <span class="comment">% [yr] Time periods</span>
FRR_obs = NaN(length(t),1);
Sum_Ai = NaN(length(t),1);
symb = [<span class="string">'d'</span>,<span class="string">'^'</span>,<span class="string">'v'</span>];
<span class="keyword">for</span> i = 1:length(t)
    in = find(yr_aab == t(i,1));
	Sum_Ai(i) = sum(aab(in:end,2));
    FRR_obs(i) = (diff(t(i,:))+1)/(Sum_Ai(i)/A); <span class="comment">% [yr]</span>
    plot(t(i,:),[FRR_obs(i) FRR_obs(i)],<span class="string">'k'</span>)
    <span class="keyword">if</span> in == 1; hold <span class="string">on</span>; <span class="keyword">end</span>
    plot(mean(t(i,:)),FRR_obs(i),<span class="string">'dk'</span>,<span class="string">'Marker'</span>,symb(i),<span class="keyword">...</span>
        <span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25],<span class="string">'MarkerSize'</span>,8)
<span class="keyword">end</span>
xlabel(<span class="string">'Time (yr CE)'</span>)
pos2 = get(gca,<span class="string">'position'</span>);
pos2([1 2 4]) = [0.5076 0.1412    0.7288];
set(gca,<span class="string">'yscale'</span>,<span class="string">'log'</span>,<span class="string">'ycolor'</span>,<span class="string">'none'</span>,<span class="string">'xtick'</span>,[1980 2000 2020],<span class="keyword">...</span>
    <span class="string">'position'</span>,pos2)
ylim(y_lim)
grid <span class="string">on</span>
box <span class="string">off</span>
text(2000,235,<span class="string">'1984-2020'</span>,<span class="string">'FontSize'</span>,fs,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)
text(2010,135,<span class="string">'2000-2020'</span>,<span class="string">'FontSize'</span>,fs,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)
text(2010,76,<span class="string">'2010-2020'</span>,<span class="string">'FontSize'</span>,fs,<span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)
title(<span class="string">'B  Obs.'</span>,<span class="string">'FontSize'</span>,fs+4)

<span class="comment">%%%% FRP under future scenarios</span>
subplot(1,6,[5 6])

t = [2000 2050; 2000 2050; 2000 2050; 2000 2100; 2000 2100; 2000 2100];
Sum_Ai_Future = [Sum_Ai(2) + Sum_Ai(1)*(30/37);<span class="keyword">...</span>
    Sum_Ai(2) + Sum_Ai(2)*(30/21);<span class="keyword">...</span>
    Sum_Ai(2) + Sum_Ai(3)*(30/11);<span class="keyword">...</span>
    Sum_Ai(2) + Sum_Ai(1)*(80/37);<span class="keyword">...</span>
    Sum_Ai(2) + Sum_Ai(2)*(80/21);<span class="keyword">...</span>
    Sum_Ai(2) + Sum_Ai(3)*(80/11)];
    <span class="comment">% 1 = repeat 1984-2020 rate;</span>
    <span class="comment">% 2 = repeat 2000-2020 rate;</span>
    <span class="comment">% 3 = repeat 2010-2020 rate.</span>
    <span class="comment">% 30 yr = 2021 through 2050;</span>
    <span class="comment">% 80 yr = 2021 through 2100;</span>
    <span class="comment">% 37 yr = 1984-2020, inclusive</span>
    <span class="comment">% 21 yr = 2000-2020, inclusive</span>
    <span class="comment">% 11 yr = 2010-2020, inclusive</span>

FRP_future = NaN(length(t),1);
symb = [<span class="string">'d'</span>,<span class="string">'^'</span>,<span class="string">'v'</span>,<span class="string">'d'</span>,<span class="string">'^'</span>,<span class="string">'v'</span>];
<span class="keyword">for</span> i = 1:length(t)
    in = find(yr_aab == t(i,1));
    FRP_future(i) = (diff(t(i,:))+1)/(Sum_Ai_Future(i)/A);
    plot(t(i,:),[FRP_future(i) FRP_future(i)],<span class="string">'--k'</span>)
    <span class="keyword">if</span> i == 1; hold <span class="string">on</span>; <span class="keyword">end</span>
    plot(mean(t(i,:)),FRP_future(i),<span class="string">'^k'</span>,<span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>,8,<span class="string">'Marker'</span>,symb(i))
<span class="keyword">end</span>
plot(mean(t(2,:)),FRP_future(2),<span class="string">'^k'</span>,<span class="string">'MarkerFaceColor'</span>,[0.8 0.25 0.25],<span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>,8)
text(2020,205,<span class="string">'Continued 1984-2020 rate'</span>,<span class="string">'FontSize'</span>,fs)
text(2020,135,<span class="string">'Continued 2000-2020 rate'</span>,<span class="string">'FontSize'</span>,fs)
text(2020,92,<span class="string">'Continued 2010-2020 rate'</span>,<span class="string">'FontSize'</span>,fs)
pos3 = get(gca,<span class="string">'position'</span>);
pos3([1 2 4]) = [0.6682 0.1412    0.7288];
set(gca,<span class="string">'yscale'</span>,<span class="string">'log'</span>,<span class="string">'yaxislocation'</span>,<span class="string">'right'</span>,<span class="string">'xtick'</span>,[2000:25:2100],<span class="keyword">...</span>
    <span class="string">'FontSize'</span>,fs,<span class="string">'position'</span>,pos3)
ylim(y_lim)
grid <span class="string">on</span>
box <span class="string">off</span>
title(<span class="string">'C  Future scenarios'</span>,<span class="string">'FontSize'</span>,fs+4)
</pre><img vspace="5" hspace="5" src="Figures_all_script_04.png" alt=""> <h2 id="16">FIGURE S3: Focal study area, with LANDFIRE-defined subalpine vegetation</h2><pre class="codeinput">figure(5); clf;

<span class="comment">%%%% Display focal study area</span>
imshow(subalpineForest);
hold <span class="string">on</span>
colormap([0.9 0.9 0.9; 0 0.6 0])

<span class="comment">%%%% Plot focal study area</span>
[latlimFoc_dis,lonlimFoc_dis] = geographicToDiscrete(R,latlimFoc,lonlimFoc);
a1 = plot([lonlimFoc_dis(1) lonlimFoc_dis(2) lonlimFoc_dis(2)<span class="keyword">...</span>
    lonlimFoc_dis(1) lonlimFoc_dis(1)],<span class="keyword">...</span>
    [latlimFoc_dis(1) latlimFoc_dis(1) latlimFoc_dis(2)<span class="keyword">...</span>
    latlimFoc_dis(2) latlimFoc_dis(1)],<span class="keyword">...</span>
    <span class="string">'color'</span>,[0.25 0.25 0.25],<span class="string">'linewidth'</span>,2);
xlim(lonlimFoc_dis)
ylim(fliplr(latlimFoc_dis))

<span class="comment">%%%% Plot Central Rockies ecoregions</span>
[I,J] = geographicToDiscrete(R,latSoRockies,lonSoRockies);
a2 = plot(J,I,<span class="string">'color'</span>,[0.5 0.5 0.5],<span class="string">'Linewidth'</span>,2);

<span class="comment">%%%% Plot MTBS + 2020 area burned</span>
nFires = length(firePerimiters);
yr_aab = [1984:2020];
<span class="keyword">for</span> i = 1:nFires
    <span class="keyword">if</span> strcmp(firePerimiters(i).Year,<span class="string">'2020'</span>)
        [i,j] = geographicToDiscrete(R,firePerimiters(i).Y,firePerimiters(i).X);
        a4 = plot(j,i,<span class="string">'-r'</span>,<span class="string">'Color'</span>,[0.6 0 0],<span class="string">'linewidth'</span>,2);
    <span class="keyword">else</span>
        [i,j] = geographicToDiscrete(R,firePerimiters(i).Y,firePerimiters(i).X);
        a3 = plot(j,i,<span class="string">'-r'</span>,<span class="string">'Color'</span>,[1 .25 .25],<span class="string">'linewidth'</span>,2);
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%%% Plot lake locations</span>
in = 1+[3 4 5 6 7 8 10 13 14 16 17 19]; <span class="comment">% Index for lakes burned in MCA</span>
[I,J] = geographicToDiscrete(R,lakeData.Latitude,lakeData.Longitude);
a5 = plot(J,I,<span class="string">'ok'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'w'</span>,<span class="string">'MarkerSize'</span>,10);
a6 = plot(J(in),I(in),<span class="string">'or'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="string">'MarkerSize'</span>,3);

<span class="comment">%%%% Plot tree-ring studies</span>
ms = 15;
lw = 2;
[j,i] = geographicToDiscrete(R,41.489185,-106.182506);
a7 = plot(i,j,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Kipfmuller and Baker (2000)</span>
[j,i] = geographicToDiscrete(R,40.438131, -105.571230);
plot(i,j,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Buechling and Baker (2004)</span>
[j,i] = geographicToDiscrete(R,40.80, -106.72);
plot(i,j,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Howe and Baker (2003)% geoplot(40.875, -107.05,'vk','MarkerFaceColor','none')</span>
[j,i] = geographicToDiscrete(R,40.3, -105.73);
plot(i,j,<span class="string">'+k'</span>,<span class="string">'MarkerSize'</span>,ms,<span class="string">'LineWidth'</span>,lw);
        <span class="comment">% Sibold et al. (2006)</span>

a0 = plot(-999,-999,<span class="string">'sk'</span>,<span class="string">'MarkerFaceColor'</span>,[0 0.6 0],<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'MarkerSize'</span>,10);

legend([a1 a2 a0 a3 a4 a5 a6 a7],<span class="string">'Focal study area'</span>,<span class="string">'Ecoregion boundry'</span>,<span class="keyword">...</span>
    <span class="string">'Subalpine forest'</span>,<span class="string">'Fires, 1984-2019'</span>,<span class="keyword">...</span>
    <span class="string">'Fires, 2020'</span>,<span class="string">'Lake (n = 20)'</span>,<span class="string">'Lake, MCA fire'</span>,<span class="string">'Dendro. (n = 4)'</span>,<span class="string">'Location'</span>,<span class="keyword">...</span>
    <span class="string">'NorthWest'</span>,<span class="string">'FontSize'</span>,fs)
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Units'</span>,<span class="string">'Centimeters'</span>,<span class="string">'position'</span>,[1 2 18 18])
text(lonlimFoc_dis(1),latlimFoc_dis(1),{<span class="string">' '</span> <span class="string">' '</span> <span class="string">'-107.80\circW'</span>},<span class="keyword">...</span>
    <span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)
[j,i] = geographicToDiscrete(R,39.75, -106.4);
text(i,j,{<span class="string">' '</span> <span class="string">' '</span> <span class="string">'-106.40\circN'</span>},<span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)
text(lonlimFoc_dis(2),latlimFoc_dis(1),{<span class="string">' '</span> <span class="string">' '</span> <span class="string">'-105.00\circW'</span>},<span class="keyword">...</span>
    <span class="string">'HorizontalAlignment'</span>,<span class="string">'Center'</span>)

text(lonlimFoc_dis(1),latlimFoc_dis(1),{<span class="string">'39.75\circN   '</span>},<span class="keyword">...</span>
    <span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>)
[j,i] = geographicToDiscrete(R,40.7250, -107.80);
text(i,j,{<span class="string">'40.73\circN   '</span>},<span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>)
text(lonlimFoc_dis(1),latlimFoc_dis(2),{<span class="string">'41.70\circN   '</span>},<span class="keyword">...</span>
    <span class="string">'HorizontalAlignment'</span>,<span class="string">'Right'</span>)
</pre><img vspace="5" hspace="5" src="Figures_all_script_05.png" alt=""> <h2 id="17">CALCULATE statistics used in the main text:</h2><pre class="codeinput"><span class="comment">% Two decades with no additional burning would have to follow 2020 for the</span>
<span class="comment">% 21st-century FRP (i.e., 2000-2040) in our focal study area to return to</span>
<span class="comment">% the late-Holocene average (of 229 yr).</span>
ans = (21+20) / (251033/A)  <span class="comment">% [yr] FRP from 2000-2040, with 0 ha burned</span>
                            <span class="comment">% from 2021-2040.</span>
                            <span class="comment">% 251033 ha = focal study area burned area</span>
                            <span class="comment">% 21+20 = time from 2000-2040.</span>

<span class="comment">% Even returning to the 1984-2020 rate of burning through 2050 would keep</span>
<span class="comment">% the 21st-century FRP near the late-Holocene limit of 150 yr.</span>
ha_yr = 252811/(2020-1984+1); <span class="comment">% [ha/yr]</span>
ans = (2050-2000+1) / ((251003+ha_yr*30)/A)
</pre><pre class="codeoutput">
ans =

  227.9807


ans =

  156.1222

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% ReadMe
%
% Make figures for main text and SI, from: 
% Higuera, P.E., Shuman, B.N., and K.D. Wolf. 202x. Rocky Mountain
% subalpine forests now burning more than any time in past millennia. In
% Revisions, PNAS. 
%
% *FILE REQUIREMENTS:*
%
%   (1) ...SouthernRockies_site_metadata.csv
%   (2) ...Calder_et_al_CharResults.csv
%   (3) ...ROMO_CharResults.csv
%   (4) ...Minckley_et_al_LWH_CharResults.csv
%
%   (5) ...ecoregp075_M331H_M331I.shp
%
%   (6) ...SRockies_Fires_1984_2020_WGS84.shp REPLACE_WITH_DASH_DASH Fire perimieteres
%   (7) ...AreaBurned_Ecoregion_FocalStudy_1984_2020.csv REPLACE_WITH_DASH_DASH Area burned
%   statistics 
%
%   (8) ...EcoSec_M331H_M331I_Mean_VPD_MaySep_1979_2020.csv REPLACE_WITH_DASH_DASH VPD data for
%   Southern Rockies study area, averaged across space. 
%   (9) ...GrandLake_Mean_VPD_MaySep_1980_2020.csv REPLACE_WITH_DASH_DASH VPD data for Grank
%   Lake, CO, as point representation for focal study area. 
%
%   (10)...trouet2013nam480pollen.csv
%   (11)...Mann08_nhcru_eiv_composite_updatedCRU_v102520.csv
%
%
% DEPENDENCIES: 
%   NONE
%
%
% Created by: P.E. Higuera
% Created on: November 2020
% Updated: April 2021
% Edited: 4/2014 for publication, by P.E. Higuera.
%
% University of Montana, PaleoEcology and Fire Ecology Lab
% https://www.cfc.umt.edu/research/paleoecologylab/
% philip.higuera@umontana.edu

clear all
close all

%% SET working directory and data directory
wd = cd; % 
dataDir = [wd(1:end-4) 'data'];

%% LOAD lake locations and metadata
lakeData = readtable([dataDir '\SouthernRockies_site_metadata.csv']);
in = lakeData.Use == 1;
lakeData = lakeData(in,:);

%% LOAD sediment-charocal based fire history data
CalderEtAl = readtable([dataDir '\Calder_et_al_CharResults.csv']);
ROMO = readtable([dataDir '\ROMO_CharResults.csv']);
LWH = readtable([dataDir '\Minckley_et_al_LWH_CharResults.csv']);

C = vertcat(CalderEtAl,ROMO,LWH);

in = C.peaks_final == 1;
FireYear = C(in,:);

siteNames = unique(C.site_name);
nSites = length(siteNames); 

%% LOAD MTBS + 2019 + 2020 fire perimiters and ecoregions - SPATIAL DATA
firePerimiters = shaperead([dataDir '\SRockies_Fires_1984_2020_WGS84.shp']);

ecoRegion = shaperead([dataDir '\ecoregp075_M331H_M331I.shp']);
[lonSoRockies,latSoRockies] = polybool('union',ecoRegion(1).X,ecoRegion(1).Y,ecoRegion(2).X,ecoRegion(2).Y);

%% LOAD MTBS + 2019 + 2020 annual area burned - ASPATIAL DATA
CR_AB = importdata([dataDir '\AreaBurned_Ecoregion_FocalStudy_1984_2020.csv']);
        % Area burned statistics for M331H + M331I ecosections (combiend),
        % for all and subalpine forest only, and for "focal study area"
        % within these combined ecosections. 
        
yr_aab = [1984:2020]; % [yr CE]
aab = zeros(length(yr_aab),2); % [ha] 
for i = 1:length(yr_aab)
    yrIn = find(CR_AB.data(:,1) == yr_aab(i));
    if yrIn
        aab(i,1) = sum(CR_AB.data(yrIn,2)); % [ha] Ecoregion AAB
        aab(i,2) = sum(CR_AB.data(yrIn,5)); % [ha] Subalpine forest in 
                                            % in focal study area AAB 
    end
end

%% LOAD LANDFIRE-defined subalpine forest, within focal study area
[A,R] = geotiffread([dataDir '\SRockies_SubalpineConiferForestESP_WGS84.tif']);
subalpineForest = double(A);

%% LOAD Central Rockies and Grand Lake May-Sep. average VPD, 1979-2020
VPD = readtable([dataDir '\EcoSec_M331H_M331I_Mean_VPD_MaySep_1979_2020.csv']);
VPD_GrandLake = readtable([dataDir '\GrandLake_Mean_VPD_MaySep_1980_2020.csv']);
    
%% LOAD paleo climate data
TrouetTemp = csvread([dataDir '\trouet2013nam480pollen.csv'],106);
Mann08 = csvread([dataDir '\Mann08_nhcru_eiv_composite_updatedCRU_v102520.csv'],1);
% SOURCE: https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT4-nh.dat https://crudata.uea.ac.uk/cru/data/temperature/  
% Downloaded 10/25/20 2:46 pm MT
% 10-yr moving average, extended from 2006 with CRU. 

%% DEFINE geographic extent of Central Rockies and Focal Study Area

% *Southern Rockies study area*
latlim = [38.35 42.8];      % [decimal deg.]
lonlim = [-108.6 -104.5];   % [decimal deg.]

% *Focal study area: used for FRP calculations to compare to paleo FRP*
latlimFoc = [39.75 41.7];   % [decimal deg.]
lonlimFoc = [-107.8 -105];  % [decimal deg.]

%% CREATE FIGURES
smFig = [1 2 9 6];
medFig = [1 2 11 15]; % 11 11
lrgFig = [1 2 18 22];  % 18 22
fs = 8; % Font size

% 1 column wide (20.5 picas / 3.42” / 8.7 cm)
% 1.5 columns wide (27 picas / 4.5” / 11.4 cm)
% 2 columns wide (42.125 picas / 7” / 17.8 cm)
% Provide all images at final size. While figures may be sized conservatively
% to save page space, PNAS reserves the right to make the final decision on
% figure size in published articles and authors may be asked to shorten
% manuscripts that exceed the stated length requirement.
% Small: approximately 9 cm x 6 cm
% Medium: approximately 11 cm x 11 cm
% Large: approximately 18 cm x 22 cm
% 
% Ensure that all numbers, letters, and symbols are no smaller than 6 points 
% (2 mm) and no larger than 12 points (6 mm) after reduction. Keep text
% sizing consistent within each graphic.
% Preassemble all composite figures. 
% Submit images in these file formats: TIFF, EPS, PDF, or PPT.

% https://www.pnas.org/authors/submitting-your-manuscript#manuscript-formatting-guidelines

%% FIGURE 1: Map and contemporary burned area
figure(1); clf; 
set(gcf,'color','w','Units','Centimeters','position',medFig)
ax = subplot(3,2,[2 4]);
pos = get(ax,'Position');
set(ax,'color','none','xcolor','none','ycolor','none')

% *A: Southern Rockies study area*
gx = geoaxes;
hold on
a1 = geoplot(latSoRockies,lonSoRockies,'color',[0.5 0.5 0.5],...
    'Linewidth',2);

% *Plot MTBS + 2019 + 2020 fire perimiters*
nFires = length(firePerimiters);
yr_aab = [1984:2020];
for i = 1:nFires
    if strcmp(firePerimiters(i).Year,'2020')
        a3 = geoplot(firePerimiters(i).Y,firePerimiters(i).X,'-r',...
        'Color',[0.6 0 0],'linewidth',2);
    else
        a2 = geoplot(firePerimiters(i).Y,firePerimiters(i).X,'-r',...
        'Color',[1 .25 .25],'linewidth',1);
    end
end
% *Plot focal study area*
a4 = geoplot([latlimFoc(1) latlimFoc(1) latlimFoc(2) latlimFoc(2) latlimFoc(1)],...
    [lonlimFoc(1) lonlimFoc(2) lonlimFoc(2) lonlimFoc(1) lonlimFoc(1)],...
    'color',[0.25 0.25 0.25],'linewidth',2);
geoplot(39.7392, -104.9,'sk','MarkerFaceColor','k')
text(39.65, -105.35,'\itDenver','Color',[0 0 0])

% *Plot lake locations*
in = 1+[3 4 5 6 7 8 10 13 14 16 17 19]; % Index for lakes burned in MCA
a5 = geoplot(lakeData.Latitude,lakeData.Longitude,'ok',...
    'MarkerFaceColor','w','MarkerSize',7);
a6 = geoplot(lakeData.Latitude(in),lakeData.Longitude(in),'or',...
    'MarkerFaceColor',[1 .25 .25],'MarkerSize',1.75);

% *Plot tree-ring studies*
ms = 6;
lw = 1.1;
a7 = geoplot(41.489185, -106.182506,'+k','MarkerSize',ms,...
    'MarkerFaceColor','none','LineWidth',lw);
        % Kipfmuller and Baker (2000)
geoplot(40.438131, -105.571230,'+k','MarkerSize',ms,...
    'MarkerFaceColor','none','LineWidth',lw);
        % Buechling and Baker (2004)
geoplot(40.80, -106.72,'+k','MarkerSize',ms,...
    'MarkerFaceColor','none','LineWidth',lw);
        % Howe and Baker (2003)% geoplot(40.875, -107.05,'vk','MarkerFaceColor','none')
geoplot(40.3, -105.73,'+k','MarkerSize',ms,'LineWidth',lw);
        % Sibold et al. (2006)

% *SET Basemap*
geobasemap('landcover')
% geobasemap('usgsimageryonly')
geolimits(latlim,lonlim)
grid on
% pos = [0.1094    -0.9 0.8521    0.8];
pos = [0.1094    0.3268    0.8521    0.6537];
set(gx,'fontsize',fs,...%'LongitudeLabel',[],'LatitudeLabel',[],...
    'Position',pos,'MapCenter',[40.6 -107.4],'color','none')
gx.LatitudeLabel.String = ' ';
gx.LongitudeLabel.String = '';
gx.Grid = 'off';
lgd = legend([a1 a4 a2 a3 a5 a6 a7],'Ecoregion','Focal study area','Fires, 1984-2019',...
    'Fires, 2020','Lake (n = 20)','Lake, MCA fire','Dendro. (n = 4)','Location',...
    'West','FontSize',fs);
lgd.Position = [0.1362 0.54 0.3173 0.1852];
text(42.70,-110.67,'A','FontSize',14,'FontWeight','Bold')

% *West-wide map*
ax = subplot(3,2,6);
pos = get(ax,'Position');
set(ax,'color','none','xcolor','none','ycolor','none')

states = shaperead('usastatehi'); % State outlines
name = 'usgsimageryonly';
% name = 'colorterrain'; 
        %%%% USGS Imagery + Topo
        url = "https://basemap.nationalmap.gov/ArcGIS/rest/services/USGSImageryOnly/MapServer/tile/${z}/${y}/${x}";
        % name = 'fulldataset'
        % url = "https://services3.arcgis.com/T4QMspbfLg3qTGWY/arcgis/rest/services/Public_Wildfire_Perimeters_View/FeatureServer/0/query?outFields=*&where=1%3D1";
        % %%%% USGS Imagery + Topo
        % name = 'usgsimagerytopo';
        % url = "https://basemap.nationalmap.gov/ArcGIS/rest/services/USGSImageryTopo/MapServer/tile/${z}/${y}/${x}";
        attribution = "USGS";
        addCustomBasemap(name,url,'Attribution',attribution,...
            'MaxZoomLevel',25)
gx = geoaxes;
hold on
for i = 1:47
    geoplot(states(i).Y,states(i).X,'color',[0.6 0.6 0.6])
end
a1 = geoplot(latSoRockies,lonSoRockies,'color',[0.75 0.75 0.75],'Linewidth',1);

geobasemap(name) 
latlimWest = [30.5 49.5]; 
lonlimWest = [-125 -102]; 
geolimits(latlimWest,lonlimWest)
grid off
gx.LongitudeAxis.Visible = 'off'; gx.LatitudeAxis.Visible = 'off';
pos = [0.1370    0.7366    0.3173    0.2264];
set(gx,'fontsize',fs-2,...%'LongitudeLabel',[],'LatitudeLabel',[],...
    'Position',pos,'AxisColor','k','LineWidth',1)

% *B: Annual area burned and climate time series*
subplot(3,2,[5 6])
x_lim = [1983 2021.5];
x = yr_aab;
y = aab(:,1); % [ha] Area burned in entire study region. 

h = bar(x,y,1);
    h(1).FaceColor = 'flat';
    h(1).CData = [0.9 0.25 0.25];
xlabel('Year (CE)')
ylabel('Area burned (ha)')
set(gca,'yscale','log','YTick',[100 10000 1000000])
hold on
for i = [2002 2012 2016 2018 2020]
    in = find(x == i);
    propAb = round(100*(y(in)./sum(y)));
    text(i,1.25*y(in),[num2str(propAb) '%'],'Rotation',0,'FontSize',fs-2,...
        'HorizontalAlignment',...
        'Center','VerticalAlignment','Bottom')
end

yyaxis right
x2 = VPD.Year(6:end);
y3 = VPD.VPD_kPa(6:end);
h2 = plot(x2,y3,'k','linewidth',2);
[r, p] = corr(y,y3,'Type','Spearman'); % Correlation between VPD and AAB
text(1985,1.225,['\rho = ' num2str(round(r*100)/100)],'FontSize',fs+2)

[r p] = corr(x2,y3,'Type','Spearman'); % Correlation between VPD and year
[r p] = corr(x',y,'Type','Spearman'); % Correlation between aab and year

ylabel('VPD (kPa)','Rotation',270,'VerticalAlignment','Bottom')
ylim([0.85 1.5])
legend([h h2],'Area burned','May-Sep. VPD',...
    'Location','NorthWest','FontSize',fs);
xlim(x_lim)
pos = [0.1250    0.0582    0.78    0.2222];%[0.0973    0.0859    0.8878    0.2802];
set(gca,'ycolor','k','position',pos,'fontsize',fs)
text(1979,1.475,'B','FontSize',14,'FontWeight','Bold')

%% FIGURE 2: Paleo-fire and climate history 
figure(2); clf
set(gcf,'color','w','Units','Centimeters','position',[1 2 11.4 22])
x_lim = [-65 2020];
x_tick = [0:200:2020]; 

%%%% Plot paleo-fire network
subplot(4,1,[1])
[lat, orderIn] = sort(lakeData.Latitude,'ascend');
yr_i = [0:25:1950]; % [yr CE]
for i = 1:nSites
    in = find(strncmp(siteNames(orderIn(i)),C.site_name,10)); % Index for sample from site i.
    x = 1950-C.age_top(in);
    y = C.char_acc(in);
    peak = C.peaks_final(in);
    in = peak > 0;
    x2 = x(in); 
    y2 = peak(in);
    if i == 1; hold on; end
    plot(x,i.*ones(size(x)),'k-')
    plot(x2,y2.*i,'ok','MarkerFaceColor','k')
    in2 = find([x2 < 820+50] .* [x2 >= 820-50]);
    plot(x2(in2),y2(in2).*i,'ok','MarkerFaceColor',[0.8 0.25 0.25])
end
plot(1950-[850 850],[0 nSites+2],'REPLACE_WITH_DASH_DASHk')
plot(1950-[1200 1200],[0 nSites+2],'REPLACE_WITH_DASH_DASHk')
pos = [0.1100    0.70    0.75    0.2558];
set(gca,'xdir','normal','ytick',[1:nSites],'yticklabel',siteNames(orderIn),...
    'xlim',x_lim,'xtick',x_tick,'XTickLabel',[1950-x_tick],...
    'ylim',[0 nSites],'tickdir','out',...
    'XAxisLocation','Top','YTick',[1:2:20],'YTickLabel',fliplr([2:2:20]),...
    'FontSize',fs,'color','none','position',pos)
grid on
xlabel('Time (yr BP)')
ylabel('Site ID')

%%%% Plot paleo temperature records
subplot(4,1,3)
hold on
x = Mann08(:,1);
in = find([x >= 1900] .* [x < 2000]);
y = Mann08(:,2) - mean(Mann08(in,2));
x2 = TrouetTemp(:,1);
in = find([x2 >= 1900] .* [x2 < 2000]);
y2 = TrouetTemp(:,2);% - mean(TrouetTemp(:,2));

plot(x,y,'k','LineWidth',1,'color',[0.8 0.25 0.25]);
plot(x2,y2,'k','LineWidth',2);
y_lim = [-0.82 1.25]; %get(gca,'ylim');
plot(1950-[850 850],y_lim,'REPLACE_WITH_DASH_DASHk')
plot(1950-[1200 1200],y_lim,'REPLACE_WITH_DASH_DASHk')
ylim(y_lim)
xlim(x_lim)
text(550,0.2,'Mann et al. (2009)','HorizontalAlignment','Right',...
    'FontSize',fs,'Color',[0.5 0.5 0.5])
text(599,-0.40,'Trouet et al. (2013)','HorizontalAlignment','Right',...
    'FontSize',fs,'Color',[0.5 0.5 0.5])
ylabel('Mean ann. temp. anomaly (\circ C)','Rotation',270,...
    'VerticalAlignment','Bottom')
pos = [ 0.1100    0.5128    0.75    0.2959];
set(gca,'xcolor','none','YAxisLocation','Right','tickdir','out',...
    'Xtick',x_tick,'color','none','position',pos,'fontsize',fs,...
    'YTick',[-0.5 0 0.5 1 1.5],'YTickLabel',{'-0.5' '0' '0.5' '1'})
box off
grid on

%%%% Plot percent sites burned summary
subplot(4,1,[4])
x_lim_C = [x_lim(1) 2110];
y_lim = [0.25 1.55];
fireYears = 1950-FireYear.age_top;
timeWindow = 100; % [yr]
timeIncrement = 10; % [yr]
xi = [0:timeIncrement:1950]; % [yr CE] 
nFires_i = NaN(size(xi));
nSites_i = NaN(size(xi));
for i = 1:length(xi)
    target = [xi(i)-timeWindow/2 xi(i)+timeWindow/2];
    in = find([fireYears > target(1)] .* [fireYears <= target(2)]);
    nFires_i(i) = length(in); % [#] Total number of fires in target window.
    
    in2 = find([(1950-C.age_top) > target(1)] .*...
        [(1950-C.age_top) <= target(2)]);  
    nSites_i(i) = length(unique(C.site_name(in2))); % [#] Number of sites recording.
end
perSitesBurned = nFires_i./nSites_i; % [%] Percent sites burned
yi = smooth(perSitesBurned,timeIncrement,'lowess');

PSB_ci = prctile(perSitesBurned,[12.5 100-12.5]); 
X = [0 2005 2005 0 0];
Y = [PSB_ci(1) PSB_ci(1) PSB_ci(2) PSB_ci(2) PSB_ci(1)];
c = fill(X,Y,[0.9 0.9 0.9],'EdgeColor',[0.75 0.75 0.75]);
hold on
b = plot([0 2005],[median(perSitesBurned) median(perSitesBurned)],'r','Color',...
    [0.8 0.25 0.25]);
a = plot(xi,yi,'-r','linewidth',2,'color',[0.8 0.25 0.25]);
plot(1950-[850 850],y_lim,'kREPLACE_WITH_DASH_DASH')
plot(1950-[1200 1200],y_lim,'kREPLACE_WITH_DASH_DASH')
grid on

ylabel('Sites burned per century (%)')
y_tick = [0.25 100/300 100/230 0.5 0.6664 100/117 1  100/68];
set(gca,'ycolor','k','tickdir','out','xtick',[0:200:2020],'ytick',...
    [0.25 0.5 1 ],'yticklabel',...
    [25 50 100])
ylim(y_lim)
xlim(x_lim_C)
yyaxis right
ylim(y_lim)
pos3 = ((1+diff(x_lim_C))*0.75)/(1+diff(x_lim));
pos = [0.1100    0.125    pos3    0.3925];

set(gca,'ytick',y_tick,'ycolor','k','fontsize',fs,'yticklabel',...
    round(100./y_tick),'position',pos,'color','none')
text(2350, y_lim(1)+0.5*diff(y_lim),'Fire rotation period (yr)',...
    'Rotation',270,'HorizontalAlignment','Center','FontSize',fs)
xlabel('Time (yr CE)')
box off

%%%% Add future range of variability
X2 = [2000 2100 2100 2000 2000];
Y2 = [100/74 100/74 100/177 100/177 100/74];
f = fill(X2,Y2,[0.98 0.72 0.72],'EdgeColor',[0.8 0 0]);

% *Add tree-ring based fire rotation periods:*
%     dendroFRP = [145 273 238 405 326 346 281 127]; % Sibold et al. 2007 
%         % (values 1-5 here, from Table 4) + Bucheling and Baker 2004 (346) + 
%         % Howe and Baker 2003 (281) + Kipfmueller and Baker 2000 (127),
%         % as summarized in Baker (2009, Table 8.1). 
%     dendro_FRPci = prctile(bootstrp(10000,'mean',dendroFRP),[2.5 97.5]);
%     SiboldYr = [-50 1950-1650];
%     plot([1700 2000],[100/mean(dndroFRP) 100/mean(dndroFRP)],'k-')
%     plot([1852 1852],100./dendro_FRPci,'k-')
% d = plot(1852,100/mean(dndroFRP),'sk','markerfacecolor',[0.8 0.25 0.25],...
%         'markersize',10);

%%%% Split up dendro data into two time periods
    dendroFRP_1737 = [252 227 217 634 420 127 349 281];
    dendroFRP_1904 = [338 329 215 247 1293 170 332 295];
        % Sibold et al. 2007 
        % (values 1-5 here, from Table 4) + Bucheling and Baker 2004 (346) + 
        % Howe and Baker 2003 (281) + Kipfmueller and Baker 2000 (127),
        % as summarized in Baker (2009, Table 8.1). 
    dendroFRP_1760ci = prctile(bootstrp(10000,'median',dendroFRP_1737),[2.5 97.5]);
    dendroFRP_1936ci = prctile(bootstrp(10000,'median',dendroFRP_1904),[2.5 97.5]);
    plot([1611 1863],[100/median(dendroFRP_1737) 100/median(dendroFRP_1737)],'k-')
    plot([1737 1737],100./dendroFRP_1760ci,'k-')
    plot([1864 1944],[100/median(dendroFRP_1904) 100/median(dendroFRP_1904)],'k-')
    plot([1904 1904],100./dendroFRP_1936ci,'k-')
d = plot(1737,100/median(dendroFRP_1737),'sk','markerfacecolor',[0.8 0.25 0.25],...
        'markersize',8);  
    plot(1904,100/median(dendroFRP_1904),'sk','markerfacecolor',[0.8 0.25 0.25],...
        'markersize',8);

%%%% Plot contemporary FRPs
e = plot(2000,100/204,'dk','markerfacecolor',[0.8 0.25 0.25],...
    'MarkerSize',8); % c. 204 yr FRP: 1984-2020
plot([2000 2100],[100/117 100/117],'r-','color',[0.8 0.25 0.25])
plot(2010,100/117,'dk','markerfacecolor',[0.8 0.25 0.25],...
    'MarkerSize',8); % c. 117 yr FRP: 2000-2020
plot(2020,100/68,'dk','markerfacecolor',[0.8 0.25 0.25],...
    'MarkerSize',8) % c. 68 yr FRP: 2000-2020
text(2010,100/68,'2010-2020  ','HorizontalAlignment','Right',...
    'Color',[0.8 0.25 0.25],'fontsize',fs)
text(2000,100/117,'2000-2020  ','HorizontalAlignment','Right',...
    'Color',[0.8 0.25 0.25],'fontsize',fs)
text(1995,0.5,'1984-2020   ','HorizontalAlignment','Right',...
    'Color',[0.3 0.3 0.3],'Rotation',-45,'fontsize',fs)
text([750+(1100-750)/2],0.875,'MCA','FontWeight','Bold',...
    'HorizontalAlignment','Center')

%%%% Annotate figure
text(-300,1.15+1.9,'A','FontSize',12,'FontWeight','Bold')
text(-300,0.9+1.15,'B','FontSize',12,'FontWeight','Bold')
text(-300,0.75+0.75,'C','FontSize',12,'FontWeight','Bold')
legend([a,b,c,d,e,f],'Lake sed.: 100-yr rate of burning',...
    'Lake sed.: median','Lake sed.: central 75% of HRV',...
    'Tree rings: median FRP (95% CI)',...
    'Observational: FRP',...
    '21^s^t-century FRP scenarios',...
    'Location','NorthWest','FontSize',8)

%% FIGURE S1: Annual area burned area in focal study area (subalpine forest only)

figure(3); clf; 
set(gcf,'color','w','Units','Centimeters','position',[1 1 11.0067 4.5])

x_lim = [1983 2021.5];
x = yr_aab;
y = aab(:,2); % [ha] Area burned in entire study region. 

h = bar(x,y,1);
    h(1).FaceColor = 'flat';
    h(1).CData = [0.9 0.25 0.25];
xlabel('Year (CE)')
ylabel('Area burned (ha)')
set(gca,'yscale','log','YTick',[100 10000 1000000])
ylim([0.1 1000000])
hold on
for i = [2002 2012 2016 2018 2020]
    in = find(x == i);
    propAb = round(100*(y(in)./sum(y)));
    text(i,1.1*y(in),[num2str(propAb) '%'],'Rotation',0,'FontSize',fs-2,...
        'HorizontalAlignment',...
        'Center','VerticalAlignment','Bottom')
 end

yyaxis right
x2 = VPD_GrandLake.Year(5:end);
y3 = VPD_GrandLake.VPD_kPa(5:end);
h2 = plot(x2,y3,'k','linewidth',2);
[r p] = corr(y,y3,'Type','Spearman'); % Correlation between VPD and AAB
text(1985,1.25,['\rho = ' num2str(round(r*100)/100)],'FontSize',fs+2)

[r p] = corr(x2,y3,'Type','Spearman'); % Correlation between VPD and year
[r p] = corr(x',y,'Type','Spearman'); % Correlation between aab and year

ylabel('VPD (kPa)','Rotation',270,'VerticalAlignment','Bottom')
ylim([0.85 1.5])
legend([h h2],'Area burned','May-Sep. VPD',...
    'Location','NorthWest','FontSize',fs-0)
xlim(x_lim)
set(gca,'ycolor','k','fontsize',fs)

%% FIGURE S2: paleo fire history and future FRP scenarios
figure(4); clf
set(gcf,'color','w','Units','Centimeters','position',[1 2 18.3 24.7/3])
y_lim = [45 350];

subplot(1,6,[1 3])
%%%% This study - composite charcoal record
plot([0 2000],[230 230],'k')
hold on
plot([1000 1000],100./PSB_ci,'k') % 25-75 percentile;
a1 = plot(1000,230,'hk','MarkerFaceColor',[0.8 0.25 0.25],...
        'MarkerSize',8);
plot([840 840],[150 150],'k')
a2 = plot(840,150,'*k','Color',[0.8 0.25 0.25],...
        'MarkerSize',8);
    
%%%% Higuera et al. 2014
plot([-4000 2000],[293 293],'k') 
plot([-1000 -1000],[249 341],'k')
a3 = plot(-1000,293,'pk','MarkerFaceColor',[0.8 0.25 0.25],...
        'MarkerSize',8);
    
%%%% Tree-ring records
% plot([1700 2000],[270 270],'k')
% plot([1850 1850],[205 329],'k')
% a4 = plot(1850,270,'sk','MarkerFaceColor',[0.8 0.25 0.25],'MarkerSize',8);
% pos = [0.0808    0.1412    0.3714    0.7288];
% set(gca,'yscale','log','FontSize',fs,'position',pos)
% ylim(y_lim)
% ylabel('Fire rotation period (yr)')
% grid on
% box off

plot([1650 1870],[median(dendroFRP_1737) median(dendroFRP_1737)],'k-')
plot([1760 1760],dendroFRP_1760ci,'k-')
plot([1871 2000],[median(dendroFRP_1904) median(dendroFRP_1904)],'k-')
plot([1936 1936],dendroFRP_1936ci,'k-')
a4 = plot(1760,median(dendroFRP_1737),'sk','markerfacecolor',[0.8 0.25 0.25],...
        'markersize',8);  
    plot(1936,median(dendroFRP_1904),'sk','markerfacecolor',[0.8 0.25 0.25],...
        'markersize',8);

pos = [0.0808    0.1412    0.3714    0.7288];
set(gca,'yscale','log','FontSize',fs,'position',pos)
ylim(y_lim)
ylabel('Fire rotation period (yr)')
grid on
box off

legend([a3 a1 a2 a4],'Sed.-charcoal records (Higuera et al. 2014)',...
    'Sed.-charcoal records (this study)',...
    'MCA max. burning rate (this study)',...
    'Tree-ring records (see caption)',...
    'Location','Southwest')
title('A  Paleo','FontSize',fs+4)
xlabel(' ')

%%%% Contemporary FRP 
subplot(1,6,4)

A = 1395870; % [ha] Size of focal study area
t = [1984 2020; 2000 2020; 2010 2020]; % [yr] Time periods
FRR_obs = NaN(length(t),1);
Sum_Ai = NaN(length(t),1);
symb = ['d','^','v'];
for i = 1:length(t)
    in = find(yr_aab == t(i,1));
	Sum_Ai(i) = sum(aab(in:end,2));
    FRR_obs(i) = (diff(t(i,:))+1)/(Sum_Ai(i)/A); % [yr] 
    plot(t(i,:),[FRR_obs(i) FRR_obs(i)],'k')
    if in == 1; hold on; end
    plot(mean(t(i,:)),FRR_obs(i),'dk','Marker',symb(i),...
        'MarkerFaceColor',[0.8 0.25 0.25],'MarkerSize',8)
end
xlabel('Time (yr CE)')
pos2 = get(gca,'position');
pos2([1 2 4]) = [0.5076 0.1412    0.7288];
set(gca,'yscale','log','ycolor','none','xtick',[1980 2000 2020],...
    'position',pos2)
ylim(y_lim)
grid on
box off
text(2000,235,'1984-2020','FontSize',fs,'HorizontalAlignment','Center')
text(2010,135,'2000-2020','FontSize',fs,'HorizontalAlignment','Center')
text(2010,76,'2010-2020','FontSize',fs,'HorizontalAlignment','Center')
title('B  Obs.','FontSize',fs+4)

%%%% FRP under future scenarios
subplot(1,6,[5 6])

t = [2000 2050; 2000 2050; 2000 2050; 2000 2100; 2000 2100; 2000 2100];
Sum_Ai_Future = [Sum_Ai(2) + Sum_Ai(1)*(30/37);... 
    Sum_Ai(2) + Sum_Ai(2)*(30/21);...
    Sum_Ai(2) + Sum_Ai(3)*(30/11);...
    Sum_Ai(2) + Sum_Ai(1)*(80/37);...
    Sum_Ai(2) + Sum_Ai(2)*(80/21);...
    Sum_Ai(2) + Sum_Ai(3)*(80/11)]; 
    % 1 = repeat 1984-2020 rate;
    % 2 = repeat 2000-2020 rate; 
    % 3 = repeat 2010-2020 rate.
    % 30 yr = 2021 through 2050; 
    % 80 yr = 2021 through 2100; 
    % 37 yr = 1984-2020, inclusive 
    % 21 yr = 2000-2020, inclusive 
    % 11 yr = 2010-2020, inclusive 
    
FRP_future = NaN(length(t),1);
symb = ['d','^','v','d','^','v'];
for i = 1:length(t)
    in = find(yr_aab == t(i,1));
    FRP_future(i) = (diff(t(i,:))+1)/(Sum_Ai_Future(i)/A);
    plot(t(i,:),[FRP_future(i) FRP_future(i)],'REPLACE_WITH_DASH_DASHk')
    if i == 1; hold on; end
    plot(mean(t(i,:)),FRP_future(i),'^k','MarkerFaceColor',[0.8 0.25 0.25],...
        'MarkerSize',8,'Marker',symb(i))
end
plot(mean(t(2,:)),FRP_future(2),'^k','MarkerFaceColor',[0.8 0.25 0.25],...
        'MarkerSize',8)
text(2020,205,'Continued 1984-2020 rate','FontSize',fs)
text(2020,135,'Continued 2000-2020 rate','FontSize',fs)
text(2020,92,'Continued 2010-2020 rate','FontSize',fs)
pos3 = get(gca,'position');
pos3([1 2 4]) = [0.6682 0.1412    0.7288];
set(gca,'yscale','log','yaxislocation','right','xtick',[2000:25:2100],...
    'FontSize',fs,'position',pos3)
ylim(y_lim)
grid on
box off
title('C  Future scenarios','FontSize',fs+4)

%% FIGURE S3: Focal study area, with LANDFIRE-defined subalpine vegetation
figure(5); clf; 

%%%% Display focal study area
imshow(subalpineForest);
hold on
colormap([0.9 0.9 0.9; 0 0.6 0])

%%%% Plot focal study area
[latlimFoc_dis,lonlimFoc_dis] = geographicToDiscrete(R,latlimFoc,lonlimFoc);
a1 = plot([lonlimFoc_dis(1) lonlimFoc_dis(2) lonlimFoc_dis(2)...
    lonlimFoc_dis(1) lonlimFoc_dis(1)],...
    [latlimFoc_dis(1) latlimFoc_dis(1) latlimFoc_dis(2)...
    latlimFoc_dis(2) latlimFoc_dis(1)],...
    'color',[0.25 0.25 0.25],'linewidth',2);
xlim(lonlimFoc_dis)
ylim(fliplr(latlimFoc_dis))

%%%% Plot Central Rockies ecoregions
[I,J] = geographicToDiscrete(R,latSoRockies,lonSoRockies);
a2 = plot(J,I,'color',[0.5 0.5 0.5],'Linewidth',2);

%%%% Plot MTBS + 2020 area burned
nFires = length(firePerimiters);
yr_aab = [1984:2020];
for i = 1:nFires
    if strcmp(firePerimiters(i).Year,'2020')
        [i,j] = geographicToDiscrete(R,firePerimiters(i).Y,firePerimiters(i).X);
        a4 = plot(j,i,'-r','Color',[0.6 0 0],'linewidth',2);
    else
        [i,j] = geographicToDiscrete(R,firePerimiters(i).Y,firePerimiters(i).X);
        a3 = plot(j,i,'-r','Color',[1 .25 .25],'linewidth',2);
    end
end

%%%% Plot lake locations
in = 1+[3 4 5 6 7 8 10 13 14 16 17 19]; % Index for lakes burned in MCA
[I,J] = geographicToDiscrete(R,lakeData.Latitude,lakeData.Longitude);
a5 = plot(J,I,'ok','MarkerFaceColor','w','MarkerSize',10);
a6 = plot(J(in),I(in),'or','MarkerFaceColor','r','MarkerSize',3);

%%%% Plot tree-ring studies
ms = 15;
lw = 2;
[j,i] = geographicToDiscrete(R,41.489185,-106.182506);
a7 = plot(i,j,'+k','MarkerSize',ms,'MarkerFaceColor','none','LineWidth',lw);
        % Kipfmuller and Baker (2000)
[j,i] = geographicToDiscrete(R,40.438131, -105.571230);
plot(i,j,'+k','MarkerSize',ms,'MarkerFaceColor','none','LineWidth',lw);
        % Buechling and Baker (2004)
[j,i] = geographicToDiscrete(R,40.80, -106.72);
plot(i,j,'+k','MarkerSize',ms,'MarkerFaceColor','none','LineWidth',lw);
        % Howe and Baker (2003)% geoplot(40.875, -107.05,'vk','MarkerFaceColor','none')
[j,i] = geographicToDiscrete(R,40.3, -105.73);
plot(i,j,'+k','MarkerSize',ms,'LineWidth',lw);
        % Sibold et al. (2006)

a0 = plot(-999,-999,'sk','MarkerFaceColor',[0 0.6 0],...
    'MarkerEdgeColor','none','MarkerSize',10);
        
legend([a1 a2 a0 a3 a4 a5 a6 a7],'Focal study area','Ecoregion boundry',...
    'Subalpine forest','Fires, 1984-2019',...
    'Fires, 2020','Lake (n = 20)','Lake, MCA fire','Dendro. (n = 4)','Location',...
    'NorthWest','FontSize',fs)
set(gcf,'color','w','Units','Centimeters','position',[1 2 18 18])
text(lonlimFoc_dis(1),latlimFoc_dis(1),{' ' ' ' '-107.80\circW'},...
    'HorizontalAlignment','Center')
[j,i] = geographicToDiscrete(R,39.75, -106.4);
text(i,j,{' ' ' ' '-106.40\circN'},'HorizontalAlignment','Center')
text(lonlimFoc_dis(2),latlimFoc_dis(1),{' ' ' ' '-105.00\circW'},...
    'HorizontalAlignment','Center')

text(lonlimFoc_dis(1),latlimFoc_dis(1),{'39.75\circN   '},...
    'HorizontalAlignment','Right')
[j,i] = geographicToDiscrete(R,40.7250, -107.80);
text(i,j,{'40.73\circN   '},'HorizontalAlignment','Right')
text(lonlimFoc_dis(1),latlimFoc_dis(2),{'41.70\circN   '},...
    'HorizontalAlignment','Right')

%% CALCULATE statistics used in the main text:

% Two decades with no additional burning would have to follow 2020 for the
% 21st-century FRP (i.e., 2000-2040) in our focal study area to return to 
% the late-Holocene average (of 229 yr). 
ans = (21+20) / (251033/A)  % [yr] FRP from 2000-2040, with 0 ha burned 
                            % from 2021-2040.
                            % 251033 ha = focal study area burned area
                            % 21+20 = time from 2000-2040.
                            
% Even returning to the 1984-2020 rate of burning through 2050 would keep 
% the 21st-century FRP near the late-Holocene limit of 150 yr.
ha_yr = 252811/(2020-1984+1); % [ha/yr]
ans = (2050-2000+1) / ((251003+ha_yr*30)/A)

##### SOURCE END #####
--></body></html>